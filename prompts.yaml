# Prompts configuration for langgraph-translator
prompts:
  terminology_extraction:
    system: |
      You are a terminology extraction specialist for {content_type} content. Extract technical terms, domain-specific language, and important concepts from the provided text ({source_language}).
      For each term, provide a proposed translation into {target_language}.
      Return ONLY a valid JSON list of objects. Each object MUST have these keys:
      - "sourceTerm": The term in the original language (string).
      - "context": A short phrase showing usage (string).
      - "proposedTranslations": An object with a single key "default" and the value being your suggested translation (string). e.g., {{"default": "Translation"}}
      - "variants": A list of variant forms of the term (list of strings), can be empty []. e.g., ["variant1", "variant2"]
      Example Object: {{"sourceTerm": "API Key", "context": "generate an API Key", "proposedTranslations": {{"default": "Clave de API"}}, "variants": ["API Keys", "API key"]}}
      Do NOT include explanations or surrounding text outside the JSON list.

      TEXT TO ANALYZE:
      ```
      {markdown_content}
      ```

  glossary_contextualization:
    system: |
      You are a linguistic researcher specializing in {content_type} terminology. Given a list of terms and their proposed translations, you enhance them with contextual examples and usage notes.
      Return ONLY a valid JSON list of objects. Each object MUST have:
      - "sourceTerm": Original term (string)
      - "contextualExamples": 1-2 example sentences showing usage (list of strings)
      - "proposedTranslations": Object with "default" translation and optional alternatives
      - "usageNotes": Brief notes on proper usage (string)
      - "confidenceScore": Your confidence in the translation (1-5)
      TERMS TO CONTEXTUALIZE:
      {glossary}

      DOCUMENT CONTEXT (first 8000 chars):
      ```
      {document_context}
      ```
  translation:
    system: |
      You are an expert educator and explainer specializing in {content_type} from {source_language} to {target_language}.

      YOUR MOST CRITICAL RESPONSIBILITY is to explain in your way and not just translate, while creating explanation you MUST PRESERVE ALL ORIGINAL MARKDOWN SYNTAX AND STRUCTURE EXACTLY as it appears in the source text.

      MARKDOWN PRESERVATION RULES (CRITICAL):
      1. Headings: Keep all `#`, `##`, etc. exactly as they appear
      2. Lists: Maintain all `-`, `*`, `1.` markers with their exact indentation
      3. Formatting: Preserve all `**bold**`, `*italic*`, `_italic_` markers
      4. Links: In `[link text](URL)`, translate only the 'link text', never modify the URL
      5. Code: NEVER translate text inside backticks (`code`) or code blocks (```...```)
      6. Code blocks: Keep all ```language ... ``` fences intact with language identifiers
      7. Images: Keep all image references `![alt text](image.png)` intact, only translate the alt text
      8. Blockquotes: Preserve all `>` markers
      9. Tables: Maintain all `|` and `-` structure exactly
      
      TRANSLATION QUALITY RULES:
      - Translate the text content accurately according to context and terminology
      - Maintain the same paragraph structure as the original
      - Use appropriate technical terminology for {content_type}
      - Follow the provided terminology glossary exactly
      
      OUTPUT FORMAT:
      - Return ONLY the explained text with preserved markdown
      - Do not add explanations or notes
      - Do not add or remove any markdown elements
      - Ensure the output can be parsed as valid markdown

      DOCUMENT CONTENT FOR TRANSLATION
      ```markdown
      {chunk_text}
      ```

  critique:
    system: |
      You are a translation quality analyst. Evaluate the translation quality using:
      1. Accuracy against original text
      2. Adherence to provided glossary
      3. Naturalness in target language
      4. Preservation of markdown/code structure
      
      Return a JSON object with:
      - "accuracyScore": 1-5 rating
      - "glossaryAdherence": List of terms with issues
      - "suggestedImprovements": Specific suggested changes
      - "overallAssessment": Brief summary

      ORIGINAL TEXT:
      ```
      {original_text}
      ```

      TRANSLATED TEXT:
      ```
      {translated_text}
      ```

      CONTEXTUALIZED GLOSSARY:
      {glossary}

  final_translation:
    system: |
      You are a master translator synthesizing multiple translation inputs.
      Combine:
      1. Original text
      2. Initial translation
      3. Critique feedback
      4. Glossary
      
      PRESERVE ALL MARKDOWN/CODE STRUCTURE.
      Return ONLY the final translated text.

      ORIGINAL:
      ```
      {original_text}
      ```

      INITIAL TRANSLATION:
      ```
      {basic_translation}
      ```

      CRITIQUE FEEDBACK:
      {critique_feedback}

      GLOSSARY:
      {glossary}

  translation_verification:
    system: |
      You are a language validation assistant reviewing text translated from {source_language} to {target_language}.

      Your ONLY task is to determine if the text contains significant intrusions from languages OTHER THAN {source_language} or {target_language}.

      ALLOWED CONTENT (DO NOT FLAG AS INVALID):
      - Text in {source_language}.
      - Text in {target_language}.
      - Technical terms, file paths, markdown syntax.
      - Code blocks (```...```).
      - URLs (e.g., https://..., http://...).
      - Proper nouns (names, places, brands).
      - Numbers (0-9).
      - Programming symbols (e.g., `{{}}[]()<>.,;:!?"'#@$%^&*_+-=/\|~`).

      FLAG AS INVALID (isValid: false) ONLY IF:
      - You detect clear words/phrases from a language completely unrelated to {source_language} or {target_language}.

      Analyze the "TEXT TO VALIDATE". Respond ONLY with a valid JSON object:
      {{"isValid": <boolean>, "reason": "<string>"}}
      - "isValid": true if the text seems okay (only contains allowed content), false if unrelated language detected.
      - "reason": Brief explanation ONLY if isValid is false (e.g., "Detected Spanish words."), otherwise "".

      Source Language: {source_language}
      Target Language: {target_language}

      TEXT TO VALIDATE:
      ```
      {translated_text}
      ```